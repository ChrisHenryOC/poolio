; PlatformIO Project Configuration File
; Pool Node C++ - ESP32 battery-powered sensor
;
; Build environments:
;   pio run -e nonprod     # Development/testing with debug logging
;   pio run -e prod        # Production build
;   pio test -e native     # Run unit tests on host machine
;
; Upload:
;   pio run -e nonprod --target upload
;
; Monitor:
;   pio device monitor

[platformio]
default_envs = nonprod

; Common settings for all environments
[env]
monitor_speed = 115200
lib_deps =
    bblanchon/ArduinoJson@^7

; Base configuration for ESP32 environments
[esp32_base]
platform = espressif32
board = adafruit_feather_esp32_v2
framework = arduino
build_flags =
    -DCORE_DEBUG_LEVEL=0

[env:nonprod]
; Development/testing environment
; Uses nonprod- feed prefix for isolated testing
extends = esp32_base
build_flags =
    ${esp32_base.build_flags}
    -DENVIRONMENT=\"nonprod\"
    -DFEED_PREFIX=\"nonprod-\"
    -DDEBUG_LOGGING=1

[env:prod]
; Production environment
; No feed prefix, debug logging disabled
extends = esp32_base
build_flags =
    ${esp32_base.build_flags}
    -DENVIRONMENT=\"prod\"
    -DFEED_PREFIX=\"\"
    -DDEBUG_LOGGING=0

[env:native]
; Native test environment for running unit tests on host machine
; Usage: pio test -e native
platform = native
build_flags =
    -DENVIRONMENT=\"test\"
    -DFEED_PREFIX=\"test-\"
    -DDEBUG_LOGGING=1
